{% extends "layout.html" %}

{% block title %}Editar Enfermedad{% endblock %}

{% block content %}
<style>
body {
    background:
        url("{{ url_for('static', filename='media/doc3.jpg') }}") center center no-repeat;
    background-size: cover;
}
</style>

<div class="min-h-screen bg-gradient-to-br from-yellow-50 to-orange-100 py-8">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Encabezado elegante -->
    <div class="text-center mb-8">
        <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full mb-4">
            <i class="fas fa-virus text-2xl text-white"></i>
        </div>
        <h1 class="text-4xl font-bold text-gray-800 mb-2">Editar Enfermedad</h1>
        <p class="text-lg text-gray-600">Modifique la información de la enfermedad</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Columna del Formulario -->
        <div class="lg:col-span-2">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <div class="flex items-center justify-between mb-8">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-edit text-yellow-600"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800">Datos de la Enfermedad</h2>
                    </div>
                    <a href="{{ url_for('gestion_enfermedades') }}" 
                       class="inline-flex items-center px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-lg transition-colors duration-200">
                        <i class="fas fa-arrow-left mr-2"></i> Volver
                    </a>
                </div>
                
                <form method="POST" class="space-y-8">
                    <div class="grid grid-cols-1 gap-8">
                        <div class="relative">
                            <label for="nombre" class="flex items-center text-sm font-semibold text-gray-700 mb-3">
                                <i class="fas fa-virus text-yellow-500 mr-2"></i>
                                Nombre de la Enfermedad <span class="text-red-500 ml-1">*</span>
                            </label>
                            <input type="text" name="nombre" id="nombre" required
                                   value="{{ enfermedad.nombre }}"
                                   placeholder="Ej: Parvovirus, Moquillo, Sarna, etc."
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white"
                                   maxlength="100">
                            <div class="mt-2 flex items-center text-xs text-gray-500">
                                <i class="fas fa-info-circle mr-1"></i>
                                Ingrese el nombre específico de la enfermedad
                            </div>
                        </div>
                        
                        <div class="relative">
                            <label for="observaciones" class="flex items-center text-sm font-semibold text-gray-700 mb-3">
                                <i class="fas fa-notes-medical text-yellow-500 mr-2"></i>
                                Observaciones
                            </label>
                            <textarea name="observaciones" id="observaciones" rows="4"
                                      placeholder="Descripción adicional, síntomas principales, tratamientos comunes, etc."
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent transition-all duration-200 bg-gray-50 hover:bg-white resize-none"
                                      maxlength="255">{{ enfermedad.observaciones or '' }}</textarea>
                            <div class="mt-2 flex justify-between items-center text-xs text-gray-500">
                                <div class="flex items-center">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    Información adicional opcional
                                </div>
                                <span id="charCount" class="font-medium">{{ (enfermedad.observaciones or '')|length }}</span>/255
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-end space-x-4 pt-8 border-t border-gray-200">
                        <a href="{{ url_for('gestion_enfermedades') }}" 
                           class="inline-flex items-center px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white font-medium rounded-lg transition-colors duration-200">
                            <i class="fas fa-times mr-2"></i> Cancelar
                        </a>
                        <button type="submit" class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white font-medium rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl">
                            <i class="fas fa-save mr-2"></i> Actualizar Enfermedad
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Columna de Información -->
        <div class="lg:col-span-1">
            <div class="bg-white rounded-xl shadow-lg p-6 sticky top-6">
                <div class="flex items-center mb-6">
                    <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-info-circle text-blue-600"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">Información</h3>
                </div>
                
                <div class="space-y-6">
                    <!-- ID -->
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-hashtag text-gray-600 mr-2"></i>
                            <h4 class="font-semibold text-gray-700">ID de Enfermedad</h4>
                        </div>
                        <p class="text-lg font-mono text-gray-900">#{{ enfermedad.Idenfermedad }}</p>
                    </div>
                    
                    <!-- Nombre Actual -->
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-virus text-gray-600 mr-2"></i>
                            <h4 class="font-semibold text-gray-700">Nombre</h4>
                        </div>
                        <p id="previewNombre" class="text-gray-900 font-medium">{{ enfermedad.nombre }}</p>
                    </div>
                    
                    <!-- Observaciones -->
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-notes-medical text-gray-600 mr-2"></i>
                            <h4 class="font-semibold text-gray-700">Observaciones</h4>
                        </div>
                        <p id="previewObservaciones" class="text-gray-900 text-sm leading-relaxed">
                            {{ enfermedad.observaciones or 'Sin observaciones' }}
                        </p>
                    </div>
                    
                    <!-- Estado -->
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <div class="flex items-center mb-2">
                            <i class="fas fa-toggle-on text-gray-600 mr-2"></i>
                            <h4 class="font-semibold text-gray-700">Estado</h4>
                        </div>
                        {% if enfermedad.estado %}
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                                <i class="fas fa-check-circle mr-1"></i>
                                Activa
                            </span>
                        {% else %}
                            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800">
                                <i class="fas fa-times-circle mr-1"></i>
                                Inactiva
                            </span>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Información adicional -->
                <div class="mt-8 bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h3 class="text-base font-semibold text-blue-800 mb-2">
                        <i class="fas fa-lightbulb mr-2"></i>
                        Información importante
                    </h3>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>• Los campos marcados con (*) son obligatorios.</li>
                        <li>• El nombre debe ser único en el sistema.</li>
                        <li>• Los cambios se aplicarán inmediatamente después de guardar.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('nombre').focus();
    
    // Validación en tiempo real
    function validateForm() {
        const nombre = document.getElementById('nombre').value.trim();
        const submitBtn = document.querySelector('button[type="submit"]');
        
        if (nombre) {
            submitBtn.disabled = false;
            submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        } else {
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
        }
    }
    
    document.getElementById('nombre').addEventListener('input', validateForm);
    document.getElementById('nombre').addEventListener('change', validateForm);
    
    // Inicializar validación
    validateForm();
    
    // Actualizar vista previa en tiempo real
    document.getElementById('nombre').addEventListener('input', function() {
        const value = this.value.trim();
        document.getElementById('previewNombre').textContent = value || '{{ enfermedad.nombre }}';
    });

    document.getElementById('observaciones').addEventListener('input', function() {
        const value = this.value.trim();
        document.getElementById('previewObservaciones').textContent = value || 'Sin observaciones';
        
        // Actualizar contador de caracteres
        document.getElementById('charCount').textContent = this.value.length;
    });
    
    // Feedback visual al enviar
    document.querySelector('form').addEventListener('submit', function(e) {
        const submitBtn = document.querySelector('button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Actualizando...';
        submitBtn.disabled = true;
    });
});
</script>
{% endblock %}
