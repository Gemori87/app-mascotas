{% extends "layout.html" %}

{% block title %}Editar Medicamento{% endblock %}

{% block content %}
<style>
body {
    background:
        url("{{ url_for('static', filename='media/revision.png') }}") center center no-repeat;
    background-size: cover;
}
</style>

<div class="text-center mb-8">
    <div class="bg-white bg-opacity-95 backdrop-blur-md rounded-2xl shadow-2xl mx-auto p-4 max-w-4xl border-2 border-blue-200 inline-block">
        <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold filter drop-shadow-2xl">
            <span class="text-blue-600 drop-shadow-2xl text-shadow-lg">üìù</span>
            <i class="fas fa-edit mx-2 text-blue-600 drop-shadow-2xl"></i>
            <span class="bg-gradient-to-r from-blue-700 via-blue-600 to-indigo-800 bg-clip-text text-transparent font-black filter drop-shadow-2xl text-shadow-lg">
                Editar Medicamento
            </span>
            <span class="text-green-600 drop-shadow-2xl text-shadow-lg">üíä</span>
        </h1>
    </div>
</div>

<div class="max-w-2xl mx-auto">
    <div class="bg-white rounded-lg shadow-md p-6 border border-gray-300">
        <div class="mb-6 pb-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                <i class="fas fa-pills mr-3 text-blue-600"></i>
                Modificar Informaci√≥n del Medicamento
            </h2>
            <p class="text-sm text-gray-600 mt-2">
                Complete los campos para actualizar la informaci√≥n del medicamento.
            </p>
        </div>

        <form action="{{ url_for('editar_medicamento', id=medicamento.Idmedicamento) }}" method="POST" class="space-y-6">
            <div>
                <label for="nombre" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-prescription-bottle mr-2 text-blue-500"></i>
                    Nombre del medicamento*
                </label>
                <input type="text" name="nombre" id="nombre" required 
                       value="{{ medicamento.nombre }}"
                       placeholder="Ej: Amoxicilina, Ibuprofeno..." 
                       class="w-full px-4 py-3 rounded-md border border-gray-300 
                              focus:border-blue-500 focus:ring-2 focus:ring-blue-200 
                              text-gray-900 placeholder-gray-500">
            </div>

            <div>
                <label for="presentacion" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-box mr-2 text-blue-500"></i>
                    Presentaci√≥n*
                </label>
                <input type="text" name="presentacion" id="presentacion" required 
                       value="{{ medicamento.presentacion }}"
                       placeholder="Ej: Tabletas 500mg, Jarabe 250ml..." 
                       class="w-full px-4 py-3 rounded-md border border-gray-300 
                              focus:border-blue-500 focus:ring-2 focus:ring-blue-200 
                              text-gray-900 placeholder-gray-500">
            </div>

            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                <h3 class="text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-info-circle mr-2 text-blue-500"></i>
                    Estado actual
                </h3>
                <span class="px-3 py-1 text-sm font-medium rounded-full
                           {{ 'bg-green-100 text-green-800' if medicamento.estado else 'bg-red-100 text-red-800' }}">
                    {{ 'Activo' if medicamento.estado else 'Inactivo' }}
                </span>
                <p class="text-xs text-gray-500 mt-2">
                    El estado se puede cambiar desde la gesti√≥n de medicamentos.
                </p>
            </div>

            <div class="flex flex-col sm:flex-row gap-4 pt-6">
                <button type="submit" 
                        class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold 
                               py-3 px-6 rounded-md transition-colors duration-200
                               focus:ring-4 focus:ring-blue-300 focus:ring-opacity-50">
                    <i class="fas fa-save mr-2"></i>
                    Actualizar Medicamento
                </button>
                
                <a href="{{ url_for('gestion_medicamentos') }}" 
                   class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-semibold 
                          py-3 px-6 rounded-md transition-colors duration-200 text-center
                          focus:ring-4 focus:ring-gray-300 focus:ring-opacity-50">
                    <i class="fas fa-times mr-2"></i>
                    Cancelar
                </a>
            </div>
        </form>

        <!-- Informaci√≥n adicional -->
        <div class="mt-8 bg-blue-50 p-4 rounded-lg border border-blue-200">
            <h3 class="text-base font-semibold text-blue-800 mb-2">
                <i class="fas fa-lightbulb mr-2"></i>
                Informaci√≥n importante
            </h3>
            <ul class="text-sm text-blue-700 space-y-1">
                <li>‚Ä¢ Los campos marcados con (*) son obligatorios.</li>
                <li>‚Ä¢ El nombre debe ser √∫nico en combinaci√≥n con la presentaci√≥n.</li>
                <li>‚Ä¢ Los cambios se aplicar√°n inmediatamente despu√©s de guardar.</li>
            </ul>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('nombre').focus();
    
    // Validaci√≥n en tiempo real
    function validateForm() {
        const nombre = document.getElementById('nombre').value.trim();
        const presentacion = document.getElementById('presentacion').value.trim();
        const submitBtn = document.querySelector('button[type="submit"]');
        
        if (nombre && presentacion) {
            submitBtn.disabled = false;
            submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        } else {
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
        }
    }
    
    ['nombre', 'presentacion'].forEach(id => {
        document.getElementById(id).addEventListener('input', validateForm);
        document.getElementById(id).addEventListener('change', validateForm);
    });
    
    // Inicializar validaci√≥n
    validateForm();
    
    // Feedback visual al enviar
    document.querySelector('form').addEventListener('submit', function(e) {
        const submitBtn = document.querySelector('button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Actualizando...';
        submitBtn.disabled = true;
    });
});
</script>
{% endblock %}
